<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.515">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Andrade Ponce">

<title>Introducci√≥n a la autocorrelaci√≥n espacial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<style>html{ scroll-behavior: smooth; }</style>
<script src="index_files/libs/font-awesome-5.13.0/js/script.js"></script>
<script src="index_files/libs/fitvids-2.1.1/fitvids.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Contenido</h2>
   
  <ul>
  <li><a href="#bienvenidos" id="toc-bienvenidos" class="nav-link active" data-scroll-target="#bienvenidos">Bienvenidos ü§üü§ü</a></li>
  <li><a href="#instrucciones" id="toc-instrucciones" class="nav-link" data-scroll-target="#instrucciones">Instrucciones üßê</a>
  <ul class="collapse">
  <li><a href="#instalaci√≥n-de-paquetes" id="toc-instalaci√≥n-de-paquetes" class="nav-link" data-scroll-target="#instalaci√≥n-de-paquetes">Instalaci√≥n de paquetes</a></li>
  <li><a href="#descargar-datos-y-script" id="toc-descargar-datos-y-script" class="nav-link" data-scroll-target="#descargar-datos-y-script">Descargar datos y script</a></li>
  </ul></li>
  <li><a href="#presentaci√≥n" id="toc-presentaci√≥n" class="nav-link" data-scroll-target="#presentaci√≥n">Presentaci√≥n üìΩÔ∏è</a></li>
  <li><a href="#c√≥digo" id="toc-c√≥digo" class="nav-link" data-scroll-target="#c√≥digo">C√≥digo üíª</a>
  <ul class="collapse">
  <li><a href="#librer√≠as" id="toc-librer√≠as" class="nav-link" data-scroll-target="#librer√≠as">Librer√≠as</a></li>
  <li><a href="#cargar-datos" id="toc-cargar-datos" class="nav-link" data-scroll-target="#cargar-datos">Cargar datos</a></li>
  <li><a href="#gr√°fico-de-detecciones" id="toc-gr√°fico-de-detecciones" class="nav-link" data-scroll-target="#gr√°fico-de-detecciones">Gr√°fico de detecciones</a></li>
  <li><a href="#histograma-de-detecci√≥nes" id="toc-histograma-de-detecci√≥nes" class="nav-link" data-scroll-target="#histograma-de-detecci√≥nes">Histograma de detecci√≥nes</a></li>
  <li><a href="#mapa-de-registros" id="toc-mapa-de-registros" class="nav-link" data-scroll-target="#mapa-de-registros">Mapa de registros</a></li>
  <li><a href="#modelando-la-frecuencia-de-registro-de-venados" id="toc-modelando-la-frecuencia-de-registro-de-venados" class="nav-link" data-scroll-target="#modelando-la-frecuencia-de-registro-de-venados">Modelando la frecuencia de registro de venados</a></li>
  <li><a href="#residuales-del-mejor-modelo" id="toc-residuales-del-mejor-modelo" class="nav-link" data-scroll-target="#residuales-del-mejor-modelo">Residuales del mejor modelo</a></li>
  <li><a href="#verificando-autocorrelaci√≥n-espacial" id="toc-verificando-autocorrelaci√≥n-espacial" class="nav-link" data-scroll-target="#verificando-autocorrelaci√≥n-espacial">Verificando autocorrelaci√≥n espacial</a>
  <ul class="collapse">
  <li><a href="#paquete-pgirmess" id="toc-paquete-pgirmess" class="nav-link" data-scroll-target="#paquete-pgirmess">Paquete <em>pgirmess</em></a></li>
  <li><a href="#paquete-ncf" id="toc-paquete-ncf" class="nav-link" data-scroll-target="#paquete-ncf">Paquete ncf</a></li>
  <li><a href="#sp-lines-con-ncf" id="toc-sp-lines-con-ncf" class="nav-link" data-scroll-target="#sp-lines-con-ncf">SP lines con ncf</a></li>
  <li><a href="#cambiando-especificaci√≥n-del-modelo" id="toc-cambiando-especificaci√≥n-del-modelo" class="nav-link" data-scroll-target="#cambiando-especificaci√≥n-del-modelo">Cambiando especificaci√≥n del modelo</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#esto-es-el-inicio-de-la-aventura" id="toc-esto-es-el-inicio-de-la-aventura" class="nav-link" data-scroll-target="#esto-es-el-inicio-de-la-aventura">Esto es el inicio de la aventura</a></li>
  <li><a href="#lecturas-recomendadas" id="toc-lecturas-recomendadas" class="nav-link" data-scroll-target="#lecturas-recomendadas">Lecturas recomendadas</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introducci√≥n a la autocorrelaci√≥n espacial</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autor</div>
  <div class="quarto-title-meta-heading">Afiliaci√≥n</div>
  
    <div class="quarto-title-meta-contents">
    <a href="https://www.researchgate.net/profile/Gabriel-Andrade-Ponce">Gabriel Andrade Ponce</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Estudiante de Doctorado -Red de Biolog√≠a y Conservaci√≥n de Vertebrados - INECOL
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    
  </div>
  

</header>

<p><a href="https://twitter.com/Gatorco_AP"><svg viewbox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>@Gatorco_AP</a> <a href="https://github.com/gpandradep"><svg viewbox="0 0 496 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>@gpandradep</a> <svg viewbox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg>gpandradep@gmail.com</p>
<section id="bienvenidos" class="level1">
<h1>Bienvenidos ü§üü§ü</h1>
<p>En esta p√°gina encontrar√°n la presentaci√≥n y los scripts para un peque√±o ejercicio donde intentaremos entender de que se trata la autocorrelaci√≥n espacial y como verificarla en nuestros datos.</p>
<p>Por favor sigue las instrucciones para descargar los paquetes y scripts.</p>
</section>
<section id="instrucciones" class="level1">
<h1>Instrucciones üßê</h1>
<section id="instalaci√≥n-de-paquetes" class="level2">
<h2 class="anchored" data-anchor-id="instalaci√≥n-de-paquetes">Instalaci√≥n de paquetes</h2>
<p>Usen el siguiente c√≥digo parra instalar los paquetes necesarios. Tambi√©n pueden instalarlos uno por uno.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="co"># Manejo de datos y gr√°ficas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"sp"</span>, <span class="co"># Manejo de datos espaciales</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"sf"</span>, <span class="co"># Manejo de datos espaciales</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"AICcmodavg"</span>, <span class="co"># selecci√≥n de modelos </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"DHARMa"</span>, <span class="co"># Diagn√≥stico de modelos</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"MASS"</span>, <span class="co"># Extensi√≥n para glm nb</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"pgirmess"</span>, <span class="co">#correlogramas</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"ncf"</span>, <span class="co"># correlogramas</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"gghighlight"</span>, <span class="co"># destacar figuras</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"showtext"</span>, <span class="co"># A√±adir texto</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"ggtext"</span>, <span class="co"># markdown ggplot</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"ggspatial"</span>, <span class="co"># objetos espaciales ggplot</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"leaflet"</span> <span class="co">#mapas interactivos</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                   ))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="descargar-datos-y-script" class="level2">
<h2 class="anchored" data-anchor-id="descargar-datos-y-script">Descargar datos y script</h2>
<p>Puedes descargar el proyecto en R que incluye los datos y los scripts. Para ello usa el siguiente boton y descomprime la carpeta donde lo desees</p>
<div class="cell">
<div class="cell-output-display">
<a href="https://github.com/gpandradep/Independencia_espacial/archive/refs/heads/master.zip">
<button class="btn btn-danger"><i class="fa fa-save"></i> Descargar proyecto</button>
</a>
</div>
</div>
</section>
</section>
<section id="presentaci√≥n" class="level1">
<h1>Presentaci√≥n üìΩÔ∏è</h1>
<div class="cell">
<div class="cell-output-display">
<div class="shareagain" style="min-width:300px;margin:1em auto;">
<iframe src="slides/slides.html" width="1600" height="900" style="border:2px solid currentColor;" loading="lazy" allowfullscreen=""></iframe>
<script>fitvids('.shareagain', {players: 'iframe'});</script>
</div>
</div>
</div>
<p><br>
</p>
<ul>
<li><a href="slides/slides.html.html">Diapositivas completas</a></li>
</ul>
</section>
<section id="c√≥digo" class="level1">
<h1>C√≥digo üíª</h1>
<section id="librer√≠as" class="level2">
<h2 class="anchored" data-anchor-id="librer√≠as">Librer√≠as</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Easily Install and Load the 'Tidyverse'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp) <span class="co"># Classes and Methods for Spatial Data</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co"># Simple Features for R</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghighlight) <span class="co"># Highlight Lines and Points in 'ggplot2'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext) <span class="co"># Using Fonts More Easily in R Graphs</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext) <span class="co"># Improved Text Rendering Support for 'ggplot2'</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggspatial) <span class="co"># Spatial Data Framework for ggplot2</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet) <span class="co"># Create Interactive Web Maps with the JavaScript 'Leaflet' Library</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg) <span class="co"># Model Selection and Multimodel Inference Based on (Q)AIC(c)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa) <span class="co"># Residual Diagnostics for Hierarchical (Multi-Level / Mixed) Regression Models</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># Support Functions and Datasets for Venables and Ripley's MASS</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Paquetes para correlogramas</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pgirmess) <span class="co"># Spatial Analysis and Data Mining for Field Ecologists</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ncf) <span class="co"># Spatial Covariance Functions</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="st">"Fira Sans"</span>, <span class="st">"firasans"</span>) <span class="co"># Familia de tipo de letra</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cargar-datos" class="level2">
<h2 class="anchored" data-anchor-id="cargar-datos">Cargar datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>CTtable <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data/CTtable.csv"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Base de coordenadas de c√°maras</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(Station, utm_x, utm_y ) <span class="co"># Seleccionar columnas que usaremos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Station</th>
<th style="text-align: right;">utm_x</th>
<th style="text-align: right;">utm_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">C1T2P1</td>
<td style="text-align: right;">693961</td>
<td style="text-align: right;">2009932</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T2P11</td>
<td style="text-align: right;">693553</td>
<td style="text-align: right;">2009643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C1T2P21</td>
<td style="text-align: right;">693144</td>
<td style="text-align: right;">2009355</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T4P1</td>
<td style="text-align: right;">693673</td>
<td style="text-align: right;">2010340</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C1T4P11</td>
<td style="text-align: right;">693264</td>
<td style="text-align: right;">2010052</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T4P21</td>
<td style="text-align: right;">692856</td>
<td style="text-align: right;">2009763</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>events_by_species <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/surveyReport/events_by_species.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type.convert</span>(<span class="at">n_events=</span> <span class="fu">col_double</span>(), <span class="co"># Convertir tipo de columna</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">n_stations=</span> <span class="fu">col_double</span>()) <span class="sc">%&gt;%</span> <span class="co"># Convertir tipo de columna</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sp_n=</span> <span class="fu">paste</span>(<span class="st">"*"</span>,species,<span class="st">"*"</span>, <span class="st">" (n= "</span>, n_events, <span class="st">" ) "</span>, <span class="at">sep =</span> <span class="st">""</span>) ) <span class="co"># Columna para los nombres del eje</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 30%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: right;">n_events</th>
<th style="text-align: right;">n_stations</th>
<th style="text-align: left;">Sp_n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aves</td>
<td style="text-align: right;">704</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;"><em>Aves</em> (n= 704 )</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bassariscus astutus</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;"><em>Bassariscus astutus</em> (n= 3 )</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Canis latrans</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;"><em>Canis latrans</em> (n= 6 )</td>
</tr>
<tr class="even">
<td style="text-align: left;">Canis lupus familiaris</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;"><em>Canis lupus familiaris</em> (n= 4 )</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Capra hircus</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;"><em>Capra hircus</em> (n= 13 )</td>
</tr>
<tr class="even">
<td style="text-align: left;">Conepatus leuconotus</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;"><em>Conepatus leuconotus</em> (n= 79 )</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>freq_reg <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data/surveyReport/events_by_station2.csv"</span>) <span class="sc">%&gt;%</span> <span class="co"># Datos de registros por estaci√≥n</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"Odocoileus virginianus"</span>) <span class="sc">%&gt;%</span> <span class="co"># Filtrar especie</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(CTtable, <span class="at">by=</span> <span class="st">"Station"</span>) <span class="co"># Unir con la base da c√°maras</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Station</th>
<th style="text-align: left;">Species</th>
<th style="text-align: right;">n_events</th>
<th style="text-align: right;">utm_x</th>
<th style="text-align: right;">utm_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">C1T2P1</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">693961</td>
<td style="text-align: right;">2009932</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T2P11</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">693553</td>
<td style="text-align: right;">2009643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C1T2P21</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">693144</td>
<td style="text-align: right;">2009355</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T4P1</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">693673</td>
<td style="text-align: right;">2010340</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C1T4P11</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">693264</td>
<td style="text-align: right;">2010052</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T4P21</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">692856</td>
<td style="text-align: right;">2009763</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="gr√°fico-de-detecciones" class="level2">
<h2 class="anchored" data-anchor-id="gr√°fico-de-detecciones">Gr√°fico de detecciones</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(ndetectionplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(events_by_species, <span class="co"># Datos</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">reorder</span>(Sp_n,n_events), <span class="co">#Ordenar sp </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span> n_events))<span class="sc">+</span> <span class="co"># No. eventos</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span> <span class="st">"identity"</span>)<span class="sc">+</span>  <span class="co"># Geometria</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gghighlight</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Odocoileus virginianus"</span>))<span class="sc">+</span> <span class="co"># Se√±alar venados</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()<span class="sc">+</span> <span class="co"># Girar ejes</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tabla de frecuencia de registro de especies"</span>, <span class="co"># T√≠tulo</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span> <span class="st">"N√∫mero de registros independientes"</span>, <span class="co"># Eje y</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span> <span class="cn">NULL</span>)<span class="sc">+</span> <span class="co"># Sin eje x</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="co"># Tema</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">'firasans'</span>, <span class="at">size =</span> <span class="dv">16</span>), <span class="co"># tipo de letra</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title.position =</span> <span class="st">'plot'</span>, <span class="co"># Marco de posici√≥n</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="co"># Negrillas </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">"mm"</span>), <span class="co"># Margenes</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co">#posici√≥n central</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y=</span> <span class="fu">element_markdown</span>())) <span class="co"># It√°lica nombre de especies</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="histograma-de-detecci√≥nes" class="level2">
<h2 class="anchored" data-anchor-id="histograma-de-detecci√≥nes">Histograma de detecci√≥nes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_reg, <span class="fu">aes</span>(<span class="at">x=</span> n_events))<span class="sc">+</span> <span class="co"># Datos</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">3</span>, <span class="at">color=</span> <span class="st">"white"</span>)<span class="sc">+</span> <span class="co"># Geometria</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">" Histograma n√∫mero de detecciones"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span> <span class="st">"N√∫mero de detecciones"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span> <span class="co"># Tema</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">'firasans'</span>, <span class="at">size =</span> <span class="dv">16</span>), <span class="co"># tipo de letra</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title.position =</span> <span class="st">'plot'</span>, <span class="co"># Marco de posici√≥n</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="co"># Negrillas </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">"mm"</span>), <span class="co"># Margenes</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">hjust =</span> <span class="fl">0.5</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mapa-de-registros" class="level2">
<h2 class="anchored" data-anchor-id="mapa-de-registros">Mapa de registros</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>UMA <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"Shape/UMA.shp"</span>) <span class="co"># Leer el shape de la UMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `UMA' from data source 
  `D:\Inecol\Proyectos\Cursos\Independencia_espacial\Shape\UMA.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 1 feature and 1 field
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 688639 ymin: 2002353 xmax: 697655 ymax: 2014011
Projected CRS: WGS 84 / UTM zone 14N</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Es importante verificar que este en la misma proyecci√≥n (CRS)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(UMA)<span class="sc">+</span> <span class="co"># shape de uma</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()<span class="sc">+</span> <span class="co"># Graficar objeto espacial</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span> freq_reg, <span class="fu">aes</span>(<span class="at">x=</span>utm_x, <span class="at">y=</span>utm_y, <span class="co"># Agregar puntos</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span> n_events, <span class="at">color=</span> n_events), <span class="co"># Tama√±o y color</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha=</span><span class="fl">0.9</span>)<span class="sc">+</span> <span class="co"># Transparencia</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>))<span class="sc">+</span> <span class="co"># Escala del radio para los puntos</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Mapa de n√∫mero detecciones venado cola blanca"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Lat"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Lon"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">size=</span> <span class="st">"N√∫mero de </span><span class="sc">\n</span><span class="st">detecciones"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">color=</span><span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>, <span class="co"># Barra de escala</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">line_width=</span><span class="dv">2</span>, <span class="at">tick_height=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tr"</span>, <span class="co"># Flecha de norte</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">"cm"</span>), <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"in"</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"in"</span>),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">style =</span> north_arrow_fancy_orienteering)<span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>, <span class="at">family =</span> <span class="st">"special"</span>))<span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">'firasans'</span>, <span class="at">size =</span> <span class="dv">16</span>), <span class="co"># tipo de letra</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title.position =</span> <span class="st">'plot'</span>, <span class="co"># Marco de posici√≥n</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="co"># Negrillas </span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">"mm"</span>), <span class="co"># Margenes</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modelando-la-frecuencia-de-registro-de-venados" class="level2">
<h2 class="anchored" data-anchor-id="modelando-la-frecuencia-de-registro-de-venados">Modelando la frecuencia de registro de venados</h2>
<p>Vamos a modelar la frecuencia de registros del venado por medio de un GLM <em>Poisson</em>. Uno de los supuestos de los GLMs es que las unidades espaciales son independientes, de manera que vamos a verificarlo. Adicionalmente, vamos a probar algunas covariables que nos ayuden a explicar la distribuci√≥n espacial de los registros. La no inclusi√≥n de una variable importante puede generar patrones en los residuales.</p>
<p>Vamos a cargar una base de datos de covariables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>covs.data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"Data/covars.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co"># covariables</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X) <span class="co"># eliminar columna X</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>covs.data<span class="sc">$</span>Cluster<span class="ot">&lt;-</span> <span class="fu">as.character</span>(covs.data<span class="sc">$</span>Cluster) <span class="co"># cluster es categ√≥rica</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">### Separar las variables n√∫mericas y categ√≥ricas</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>cov.num <span class="ot">&lt;-</span> covs.data <span class="sc">%&gt;%</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="co"># Seleccionar columnas num√©ricas</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>() <span class="sc">%&gt;%</span>  <span class="co"># estandarizar</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>cov.fac <span class="ot">&lt;-</span> covs.data <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.character)) <span class="co"># Seleccionar variables de caracter</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="do">### Unir las bases</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>sp_glmdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(cov.fac, cov.num) <span class="sc">%&gt;%</span> <span class="co"># Unir covariables</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(freq_reg, <span class="at">by=</span> <span class="st">"Station"</span>)<span class="co"># Unir con la base de rgistros</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Station</th>
<th style="text-align: left;">Cam</th>
<th style="text-align: left;">Habitat</th>
<th style="text-align: left;">Cluster</th>
<th style="text-align: right;">Vertcover_50</th>
<th style="text-align: right;">Dcrops</th>
<th style="text-align: right;">MSAVI</th>
<th style="text-align: right;">Slope</th>
<th style="text-align: right;">Effort</th>
<th style="text-align: right;">Dpop_G</th>
<th style="text-align: left;">Species</th>
<th style="text-align: right;">n_events</th>
<th style="text-align: right;">utm_x</th>
<th style="text-align: right;">utm_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">C1T2P1</td>
<td style="text-align: left;">MoultrieA30</td>
<td style="text-align: left;">Scrub</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">-0.4744602</td>
<td style="text-align: right;">0.6765368</td>
<td style="text-align: right;">0.7316819</td>
<td style="text-align: right;">-0.2195550</td>
<td style="text-align: right;">-0.2080680</td>
<td style="text-align: right;">-0.4260974</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">693961</td>
<td style="text-align: right;">2009932</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T2P11</td>
<td style="text-align: left;">Moultrie</td>
<td style="text-align: left;">Scrub</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.6519157</td>
<td style="text-align: right;">1.4620448</td>
<td style="text-align: right;">-0.8666152</td>
<td style="text-align: right;">-0.9927301</td>
<td style="text-align: right;">-1.4605398</td>
<td style="text-align: right;">-0.3167450</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">693553</td>
<td style="text-align: right;">2009643</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C1T2P21</td>
<td style="text-align: left;">MoultrieA30</td>
<td style="text-align: left;">Scrub</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">-0.9243340</td>
<td style="text-align: right;">2.2193059</td>
<td style="text-align: right;">-0.5838870</td>
<td style="text-align: right;">-1.0258694</td>
<td style="text-align: right;">-0.0719298</td>
<td style="text-align: right;">-0.1805434</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">693144</td>
<td style="text-align: right;">2009355</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T4P1</td>
<td style="text-align: left;">Primos</td>
<td style="text-align: left;">Columnar</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">-0.9243340</td>
<td style="text-align: right;">0.4603495</td>
<td style="text-align: right;">-0.1430110</td>
<td style="text-align: right;">1.4183658</td>
<td style="text-align: right;">-0.8887592</td>
<td style="text-align: right;">-0.1922714</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">693673</td>
<td style="text-align: right;">2010340</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C1T4P11</td>
<td style="text-align: left;">MoultrieA30</td>
<td style="text-align: left;">Scrub</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">-1.1509622</td>
<td style="text-align: right;">1.1723154</td>
<td style="text-align: right;">0.2129457</td>
<td style="text-align: right;">-0.0597006</td>
<td style="text-align: right;">-0.0719298</td>
<td style="text-align: right;">-0.0948151</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">693264</td>
<td style="text-align: right;">2010052</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1T4P21</td>
<td style="text-align: left;">Primos</td>
<td style="text-align: left;">Scrub</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.6519157</td>
<td style="text-align: right;">1.9052628</td>
<td style="text-align: right;">0.5284530</td>
<td style="text-align: right;">-1.0258694</td>
<td style="text-align: right;">-0.0719298</td>
<td style="text-align: right;">0.0268169</td>
<td style="text-align: left;">Odocoileus virginianus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">692856</td>
<td style="text-align: right;">2009763</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ahora ajustemos algunos modelos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Modelos lineales generalizados </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sin variables</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(n_events<span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Formula</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> sp_glmdata, <span class="co"># datos</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="st">"poisson"</span>) <span class="co"># tipo de distribuci√≥n</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># la frecuencia de registro afectada por la distancia a cultivo</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(n_events<span class="sc">~</span> Dcrops, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> sp_glmdata, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># la frecuencia de registro afectada por el verdor de la vegetaci√≥n</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(n_events<span class="sc">~</span> MSAVI, </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> sp_glmdata, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># la frecuencia de registro afectada por la pendiente</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(n_events<span class="sc">~</span> Slope, </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> sp_glmdata, <span class="at">family =</span> <span class="st">"poisson"</span>) </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>          <span class="co">#family = "poisson")</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># la frecuencia de registro afectada por la distancia a poblados</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(n_events<span class="sc">~</span> Dpop_G, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> sp_glmdata, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># la frecuencia de registro afectada por el tipo de habitat</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(n_events<span class="sc">~</span> Habitat, </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> sp_glmdata, <span class="at">family =</span> <span class="st">"poisson"</span> )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Seleccionamos el ‚Äúmejor‚Äù con el criterio de informaci√≥n de Akaike</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lista_mods <span class="ot">&lt;-</span> <span class="fu">list</span>(m0, m1, m2, m3, m4, m5)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mod_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"freq~ 1"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"freq~ D_cultivos"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"freq~ MSAVI"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"freq~ Slope"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"freq~ D_poblado"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"freq~ Habitat"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>AIC <span class="ot">&lt;-</span> <span class="fu">aictab</span>(lista_mods, <span class="co"># Lista de modelos</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">modnames =</span> mod_names,  <span class="co"># nombres</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">second.ord =</span> F, <span class="co"># Seleccionar AIC</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">sort =</span> T) <span class="co"># Ordenar por menor valor</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(AIC)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 4%">
<col style="width: 22%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 13%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Modnames</th>
<th style="text-align: right;">K</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">Delta_AIC</th>
<th style="text-align: right;">ModelLik</th>
<th style="text-align: right;">AICWt</th>
<th style="text-align: right;">LL</th>
<th style="text-align: right;">Cum.Wt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">freq~ Habitat</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">440.0256</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-216.0128</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">freq~ MSAVI</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">497.6351</td>
<td style="text-align: right;">57.60950</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-246.8175</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">freq~ D_cultivos</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">511.1291</td>
<td style="text-align: right;">71.10355</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-253.5646</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">freq~ D_poblado</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">512.4230</td>
<td style="text-align: right;">72.39737</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-254.2115</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">freq~ Slope</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">512.4941</td>
<td style="text-align: right;">72.46851</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-254.2471</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">freq~ 1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">513.1820</td>
<td style="text-align: right;">73.15641</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-255.5910</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Podemos inspeccionar el mejor modelo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># para inspeccionar el modelo usar la funci√≥n summary</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = n_events ~ Habitat, family = "poisson", data = sp_glmdata)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.5702  -2.4202  -0.7741   0.4265   7.9420  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    1.0745     0.1104   9.730   &lt;2e-16 ***
Habitatcrop    0.0241     0.4229   0.057    0.955    
Habitatsalt    2.3267     0.2134  10.904   &lt;2e-16 ***
HabitatScrub   0.1203     0.1462   0.823    0.410    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 373.16  on 63  degrees of freedom
Residual deviance: 294.00  on 60  degrees of freedom
AIC: 440.03

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Dado al car√°cter relativo del AIC es necesario verificar que el mejor modelo es un buen modelo. Un mal ajuste puede ser causado por la existencia de autocorrelaci√≥n en los residuales.</p>
</section>
<section id="residuales-del-mejor-modelo" class="level2">
<h2 class="anchored" data-anchor-id="residuales-del-mejor-modelo">Residuales del mejor modelo</h2>
<p>Debido a que es un GLM de familia poisson los residuales no est√°n definidos como en un modelo lineal simple. La funci√≥n simulateResidual permite obtener una aproximaci√≥n de residuales escalados para este tipo de modelos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificamos visualmente que el modelo cumpla los requisitos de la distribuci√≥n</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>residuales <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> m5, <span class="at">plot =</span>F)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotQQunif</span>(residuales)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Creamos un data set con los residuales y las coordenadas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos el data.frame para el correlograma</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data_resm5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">res=</span><span class="fu">residuals</span>(residuales), <span class="co"># Residuales que creamos</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span> sp_glmdata<span class="sc">$</span>utm_x,<span class="co"># coordenadas en x</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y=</span> sp_glmdata<span class="sc">$</span>utm_y) <span class="co"># coordenadas en y</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">res</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0005904</td>
<td style="text-align: right;">693961</td>
<td style="text-align: right;">2009932</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4597318</td>
<td style="text-align: right;">693553</td>
<td style="text-align: right;">2009643</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">693144</td>
<td style="text-align: right;">2009355</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2011827</td>
<td style="text-align: right;">693673</td>
<td style="text-align: right;">2010340</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">693264</td>
<td style="text-align: right;">2010052</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0312027</td>
<td style="text-align: right;">692856</td>
<td style="text-align: right;">2009763</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Mapa de los residuales</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(map_res <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(UMA)<span class="sc">+</span> <span class="co"># shape de uma</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>()<span class="sc">+</span> <span class="co"># Graficar objeto espacial</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span> data_resm5, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="co"># Agregar puntos</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span> res, <span class="at">color=</span> res), <span class="co"># Tama√±o y color</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha=</span><span class="fl">0.9</span>)<span class="sc">+</span> <span class="co"># Transparencia</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>))<span class="sc">+</span> <span class="co"># Escala del radio para los puntos</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Mapa de residuales modelo m5"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span> <span class="st">"Lat"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span> <span class="st">"Lon"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">size=</span> <span class="st">"N√∫mero de </span><span class="sc">\n</span><span class="st">detecciones"</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">color=</span><span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>, <span class="co"># Barra de escala</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">line_width=</span><span class="dv">2</span>, <span class="at">tick_height=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tr"</span>, <span class="co"># Flecha de norte</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">"cm"</span>), <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"in"</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"in"</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">style =</span> north_arrow_fancy_orienteering)<span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>, <span class="at">family =</span> <span class="st">"special"</span>))<span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">'firasans'</span>, <span class="at">size =</span> <span class="dv">16</span>), <span class="co"># tipo de letra</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title.position =</span> <span class="st">'plot'</span>, <span class="co"># Marco de posici√≥n</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="co"># Negrillas </span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">"mm"</span>), <span class="co"># Margenes</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">hjust =</span> <span class="fl">0.5</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="verificando-autocorrelaci√≥n-espacial" class="level2">
<h2 class="anchored" data-anchor-id="verificando-autocorrelaci√≥n-espacial">Verificando autocorrelaci√≥n espacial</h2>
<p>El test de Moran I b√°sicamente es la extensi√≥n de una prueba de correlaci√≥n de Pearson para las diferentes distancias entre unidades de muestreo. El objetivo es estimar el grado de correlaci√≥n espacial de una misma variable. Cuando ploteamos el valor de I para las diferentes distancias tenemos un correlograma espacial</p>
<p>Hay diferentes paquetes que permiten generar los correlogramas, cada una tiene sus virtudes y puede ser m√°s conveniente o no, dependiendo de la cap√°cidad de programaci√≥n del usuario y los datos.</p>
<p>Primero vamos a generar la matriz de distancia. Para asegurar que cada categor√≠a de distancia tenga suficientes pares se recomienda trabajar con 2/3 de la m√°xima distancia. En este caso la m√°xima distancia es ~ 8km</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Wdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span> sp_glmdata<span class="sc">$</span>utm_x,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y=</span> sp_glmdata<span class="sc">$</span>utm_y) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>maxd <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span><span class="sc">*</span> <span class="fu">max</span>(Wdist)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>maxd</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5410.514</code></pre>
</div>
</div>
<section id="paquete-pgirmess" class="level3">
<h3 class="anchored" data-anchor-id="paquete-pgirmess">Paquete <em>pgirmess</em></h3>
<p><code>pgirmess</code> llama las funciones de <code>spdep</code> con una sintaxis mas amigable, lo que a su vez lo hace menos flexible. Esta aproximaci√≥n asume que la variable de respuesta se distribuye de manera normal para calcular los p valores</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pgirmess_correg <span class="ot">&lt;-</span> pgirmess<span class="sc">::</span><span class="fu">correlog</span>(<span class="at">coords =</span> <span class="fu">cbind</span>(data_resm5<span class="sc">$</span>x, <span class="co"># coordenada x</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                                                     data_resm5<span class="sc">$</span>y), <span class="co"># coordenada y</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">z=</span> data_resm5<span class="sc">$</span>res, <span class="co"># residuales</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">method =</span> <span class="st">"Moran"</span>, <span class="co"># Tipo dem√©todo</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">nbclass =</span> <span class="cn">NULL</span>) <span class="co"># Autom√°ticamente el n√∫mero de pares</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">dist.class</th>
<th style="text-align: right;">coef</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">721.7898</td>
<td style="text-align: right;">0.0294411</td>
<td style="text-align: right;">0.2755318</td>
<td style="text-align: right;">356</td>
</tr>
<tr class="even">
<td style="text-align: right;">1364.7448</td>
<td style="text-align: right;">-0.0651344</td>
<td style="text-align: right;">0.7410662</td>
<td style="text-align: right;">368</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2007.6997</td>
<td style="text-align: right;">-0.0740384</td>
<td style="text-align: right;">0.8288021</td>
<td style="text-align: right;">526</td>
</tr>
<tr class="even">
<td style="text-align: right;">2650.6546</td>
<td style="text-align: right;">-0.0101852</td>
<td style="text-align: right;">0.4619799</td>
<td style="text-align: right;">560</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3293.6096</td>
<td style="text-align: right;">0.0479433</td>
<td style="text-align: right;">0.1357293</td>
<td style="text-align: right;">548</td>
</tr>
<tr class="even">
<td style="text-align: right;">3936.5645</td>
<td style="text-align: right;">0.1084853</td>
<td style="text-align: right;">0.0224445</td>
<td style="text-align: right;">496</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4579.5194</td>
<td style="text-align: right;">0.0807245</td>
<td style="text-align: right;">0.0852875</td>
<td style="text-align: right;">432</td>
</tr>
<tr class="even">
<td style="text-align: right;">5222.4744</td>
<td style="text-align: right;">-0.0904677</td>
<td style="text-align: right;">0.8024336</td>
<td style="text-align: right;">308</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5865.4293</td>
<td style="text-align: right;">-0.1115091</td>
<td style="text-align: right;">0.8297352</td>
<td style="text-align: right;">264</td>
</tr>
<tr class="even">
<td style="text-align: right;">6508.3842</td>
<td style="text-align: right;">0.0223829</td>
<td style="text-align: right;">0.3466816</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7151.3392</td>
<td style="text-align: right;">-0.3394159</td>
<td style="text-align: right;">0.9428442</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: right;">7794.2941</td>
<td style="text-align: right;">-0.2052650</td>
<td style="text-align: right;">0.5430549</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="paquete-ncf" class="level3">
<h3 class="anchored" data-anchor-id="paquete-ncf">Paquete ncf</h3>
<p>La ventaja del paquete ncf es que permite generar correlogramas usando un test de significancia no param√©trico, por medio simulaciones Monte Carlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ncf_correg <span class="ot">&lt;-</span> ncf<span class="sc">::</span><span class="fu">correlog</span>(<span class="at">x=</span>data_resm5<span class="sc">$</span>x, <span class="co"># coordenadas en x</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y=</span>data_resm5<span class="sc">$</span>y, <span class="co"># coordenadas en y</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">z=</span>data_resm5<span class="sc">$</span>res, <span class="co"># variable de inter√©s,</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">latlon =</span>  <span class="cn">FALSE</span>, <span class="co">#formato lat lon</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">na.rm=</span>T, <span class="co"># en caso de NAs</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">increment =</span> <span class="dv">700</span>, <span class="co"># Distancia m√≠nima de unidades</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">resamp=</span><span class="dv">500</span>) <span class="co"># N√∫mero de remuestreos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>50  of  500 
100  of  500 
150  of  500 
200  of  500 
250  of  500 
300  of  500 
350  of  500 
400  of  500 
450  of  500 
500  of  500 </code></pre>
</div>
</div>
<p>Modificamos data frame para la gr√°fica</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>corbase <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">coef=</span>ncf_correg<span class="sc">$</span>correlation, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dist.class=</span> ncf_correg<span class="sc">$</span>mean.of.class, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.value=</span> ncf_correg<span class="sc">$</span>p,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n=</span> ncf_correg<span class="sc">$</span>n )<span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">as.data.frame</span>(pgirmess_correg)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">package=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"ncf"</span>, <span class="dv">12</span>), <span class="fu">rep</span>(<span class="st">"pgirmess"</span>,<span class="dv">12</span>)),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_valor=</span> <span class="fu">if_else</span>(p.value<span class="sc">&lt;</span><span class="fl">0.025</span>, <span class="st">"significativo"</span>, <span class="st">"no-significativo"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 8%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 13%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">coef</th>
<th style="text-align: right;">dist.class</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">n</th>
<th style="text-align: left;">package</th>
<th style="text-align: left;">p_valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0858466</td>
<td style="text-align: right;">527.4675</td>
<td style="text-align: right;">0.1736527</td>
<td style="text-align: right;">83</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0267224</td>
<td style="text-align: right;">1044.7161</td>
<td style="text-align: right;">0.2375250</td>
<td style="text-align: right;">198</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">-0.0938991</td>
<td style="text-align: right;">1756.1699</td>
<td style="text-align: right;">0.1217565</td>
<td style="text-align: right;">224</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">-0.1348618</td>
<td style="text-align: right;">2438.5924</td>
<td style="text-align: right;">0.0219561</td>
<td style="text-align: right;">318</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.0710109</td>
<td style="text-align: right;">3154.0392</td>
<td style="text-align: right;">0.0479042</td>
<td style="text-align: right;">310</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.0799903</td>
<td style="text-align: right;">3842.9786</td>
<td style="text-align: right;">0.0339321</td>
<td style="text-align: right;">278</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.0749898</td>
<td style="text-align: right;">4526.0347</td>
<td style="text-align: right;">0.0419162</td>
<td style="text-align: right;">232</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">-0.1415474</td>
<td style="text-align: right;">5243.6160</td>
<td style="text-align: right;">0.0339321</td>
<td style="text-align: right;">162</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">-0.0848323</td>
<td style="text-align: right;">5908.4188</td>
<td style="text-align: right;">0.1916168</td>
<td style="text-align: right;">138</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.0546072</td>
<td style="text-align: right;">6567.7873</td>
<td style="text-align: right;">0.2774451</td>
<td style="text-align: right;">54</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">-0.6117002</td>
<td style="text-align: right;">7212.9125</td>
<td style="text-align: right;">0.0139721</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: right;">-0.3202232</td>
<td style="text-align: right;">7906.3521</td>
<td style="text-align: right;">0.2335329</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">ncf</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">‚Ä¶13</td>
<td style="text-align: right;">0.0294411</td>
<td style="text-align: right;">721.7898</td>
<td style="text-align: right;">0.2755318</td>
<td style="text-align: right;">356</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">‚Ä¶14</td>
<td style="text-align: right;">-0.0651344</td>
<td style="text-align: right;">1364.7448</td>
<td style="text-align: right;">0.7410662</td>
<td style="text-align: right;">368</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">‚Ä¶15</td>
<td style="text-align: right;">-0.0740384</td>
<td style="text-align: right;">2007.6997</td>
<td style="text-align: right;">0.8288021</td>
<td style="text-align: right;">526</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">‚Ä¶16</td>
<td style="text-align: right;">-0.0101852</td>
<td style="text-align: right;">2650.6546</td>
<td style="text-align: right;">0.4619799</td>
<td style="text-align: right;">560</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">‚Ä¶17</td>
<td style="text-align: right;">0.0479433</td>
<td style="text-align: right;">3293.6096</td>
<td style="text-align: right;">0.1357293</td>
<td style="text-align: right;">548</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">‚Ä¶18</td>
<td style="text-align: right;">0.1084853</td>
<td style="text-align: right;">3936.5645</td>
<td style="text-align: right;">0.0224445</td>
<td style="text-align: right;">496</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">‚Ä¶19</td>
<td style="text-align: right;">0.0807245</td>
<td style="text-align: right;">4579.5194</td>
<td style="text-align: right;">0.0852875</td>
<td style="text-align: right;">432</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">‚Ä¶20</td>
<td style="text-align: right;">-0.0904677</td>
<td style="text-align: right;">5222.4744</td>
<td style="text-align: right;">0.8024336</td>
<td style="text-align: right;">308</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">‚Ä¶21</td>
<td style="text-align: right;">-0.1115091</td>
<td style="text-align: right;">5865.4293</td>
<td style="text-align: right;">0.8297352</td>
<td style="text-align: right;">264</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">‚Ä¶22</td>
<td style="text-align: right;">0.0223829</td>
<td style="text-align: right;">6508.3842</td>
<td style="text-align: right;">0.3466816</td>
<td style="text-align: right;">126</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">‚Ä¶23</td>
<td style="text-align: right;">-0.3394159</td>
<td style="text-align: right;">7151.3392</td>
<td style="text-align: right;">0.9428442</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
<tr class="even">
<td style="text-align: left;">‚Ä¶24</td>
<td style="text-align: right;">-0.2052650</td>
<td style="text-align: right;">7794.2941</td>
<td style="text-align: right;">0.5430549</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">pgirmess</td>
<td style="text-align: left;">no-significativo</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Generamos nuestro gr√°fico</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">ggplot</span>(corbase ,<span class="fu">aes</span>(<span class="at">x=</span>dist.class, <span class="at">y=</span>coef, <span class="at">group=</span> package))<span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span> <span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.9</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill=</span> package, <span class="at">shape=</span>p_valor), </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span> <span class="dv">21</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">stroke =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8000</span>, <span class="at">by=</span><span class="dv">500</span>),<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">6000</span>))<span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Unidades de distancia (m)"</span>, <span class="at">y=</span> <span class="st">" Moran I"</span>, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">" Correlograma de residuales"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour=</span> <span class="st">"Librer√≠a"</span>)<span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">'firasans'</span>, <span class="at">size =</span> <span class="dv">20</span>), <span class="co"># tipo de letra</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title.position =</span> <span class="st">'plot'</span>, <span class="co"># Marco de posici√≥n</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="co"># Negrillas </span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">0</span>, </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">unit =</span> <span class="st">"mm"</span>), <span class="co"># Margenes</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>))) <span class="co"># posici√≥n de la legenda</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sp-lines-con-ncf" class="level3">
<h3 class="anchored" data-anchor-id="sp-lines-con-ncf">SP lines con ncf</h3>
<p><code>ncf</code> tambi√©n permite ajustar splines cubicas por medio de bootstrap, en este caso no es necesario definir cortes de pares de distancias y permite obtener intervalos de confianza</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>spline <span class="ot">&lt;-</span> ncf<span class="sc">::</span><span class="fu">spline.correlog</span>(<span class="at">x=</span>data_resm5<span class="sc">$</span>x, <span class="co"># coordenadas en x</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y=</span>data_resm5<span class="sc">$</span>y, <span class="co"># coordenadas en y</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">z=</span>data_resm5<span class="sc">$</span>res,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">xmax =</span> maxd, <span class="co"># distancia m√°xima</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">type =</span> <span class="st">"boot"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">resamp =</span> <span class="dv">500</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>50  of  500 
100  of  500 
150  of  500 
200  of  500 
250  of  500 
300  of  500 
350  of  500 
400  of  500 
450  of  500 
500  of  500 </code></pre>
</div>
</div>
<p>Podemos hacer un plot de manera muy sencilla con <code>plot(spline)</code>, pero como yo soy terco la quiero hacer con ggplot.</p>
<p>Primero extraigo los valores de la gr√°fica</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>spl_dist <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(spline[[<span class="st">"boot"</span>]][[<span class="st">"boot.summary"</span>]][[<span class="st">"predicted"</span>]][[<span class="st">"x"</span>]]) <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>sp_base <span class="ot">&lt;-</span> spline[[<span class="st">"boot"</span>]][[<span class="st">"boot.summary"</span>]][[<span class="st">"predicted"</span>]][[<span class="st">"y"</span>]][<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">10</span>),] <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist=</span> spl_dist[,<span class="dv">1</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">0.025</th>
<th style="text-align: right;">0.5</th>
<th style="text-align: right;">0.975</th>
<th style="text-align: right;">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.3913975</td>
<td style="text-align: right;">0.2270661</td>
<td style="text-align: right;">0.8238693</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.3849227</td>
<td style="text-align: right;">0.2215995</td>
<td style="text-align: right;">0.8070617</td>
<td style="text-align: right;">18.09537</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.3784716</td>
<td style="text-align: right;">0.2168107</td>
<td style="text-align: right;">0.7902542</td>
<td style="text-align: right;">36.19073</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.3690833</td>
<td style="text-align: right;">0.2123728</td>
<td style="text-align: right;">0.7734467</td>
<td style="text-align: right;">54.28610</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.3599373</td>
<td style="text-align: right;">0.2074751</td>
<td style="text-align: right;">0.7566391</td>
<td style="text-align: right;">72.38146</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.3539569</td>
<td style="text-align: right;">0.2023594</td>
<td style="text-align: right;">0.7398316</td>
<td style="text-align: right;">90.47683</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ahora si el gr√°fico</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(splineplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sp_base, <span class="fu">aes</span>(<span class="at">x=</span> dist, <span class="at">y=</span> <span class="st">`</span><span class="at">0.5</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> <span class="st">`</span><span class="at">0.025</span><span class="st">`</span>, <span class="at">ymax=</span> <span class="st">`</span><span class="at">0.975</span><span class="st">`</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span> <span class="st">"lightgray"</span>)<span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8000</span>, <span class="at">by=</span><span class="dv">500</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(sp_base<span class="sc">$</span>dist), <span class="fu">max</span>(sp_base<span class="sc">$</span>dist)),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">500</span>, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">colour=</span> <span class="st">"blue"</span>, <span class="at">size=</span><span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"curve"</span>, <span class="at">x =</span> <span class="dv">900</span>, <span class="at">y =</span> <span class="fl">0.7</span>, <span class="at">xend =</span> <span class="dv">530</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">curvature =</span> .<span class="dv">3</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)), <span class="at">size=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">930</span>, <span class="at">y =</span> <span class="fl">0.7</span>, <span class="at">size=</span> <span class="dv">5</span>, </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Distancia m√≠nima"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)<span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Unidades de distancia (m)"</span>, <span class="at">y=</span> <span class="st">" Moran I"</span>, </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">" Spatial line de residuales"</span>)<span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">'firasans'</span>, <span class="at">size =</span> <span class="dv">20</span>), <span class="co"># tipo de letra</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title.position =</span> <span class="st">'plot'</span>, <span class="co"># Marco de posici√≥n</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>, <span class="co"># Negrillas </span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">0</span>, </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">unit =</span> <span class="st">"mm"</span>), <span class="co"># Margenes</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>))) <span class="co"># posici√≥n de la legenda</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lo que podemos concluir con todas las aproximaciones vistas es que parece ser que no hay una autocorrelaci√≥n espacial fuerte de los residuales de nuestro modelo m5. Esto quiere decir que las desviaciones de la normalidad se deben a otro factor.</p>
</section>
<section id="cambiando-especificaci√≥n-del-modelo" class="level3">
<h3 class="anchored" data-anchor-id="cambiando-especificaci√≥n-del-modelo">Cambiando especificaci√≥n del modelo</h3>
<p>Ajustamos otro modelo que asumen una distribuci√≥n de error *binomial negativa*. Con ello nos damos cuenta que el problema era el tipo de distribuci√≥n.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m5bn <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(n_events<span class="sc">~</span> Habitat, <span class="at">data =</span> sp_glmdata)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(m5bn)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.52823, p-value = 0.624
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>residuales.bn <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> m5bn, <span class="at">plot =</span>F)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotQQunif</span>(residuales.bn)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sorpresa üëΩ</p>
</section>
</section>
</section>
<section id="esto-es-el-inicio-de-la-aventura" class="level1">
<h1>Esto es el inicio de la aventura</h1>
<p>Esto fue un ejercicio sencillo, pero lidiar con la ACS merece realizar diversas lecturas en el tema, conocer los supuestos de las t√©cnicas y aprender a interpretar los resultados.</p>
<p>En caso de encontrar ACS y dependiendo de los objetivos es recomendable usar herramientas como modelos de m√≠nimos cuadrados generalizados (GLS), modelos mixtos, considerar a las coordenadas como covariables o modelos autorregresivos.</p>
</section>
<section id="lecturas-recomendadas" class="level1">
<h1>Lecturas recomendadas</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://d23gn3985hkc32.cloudfront.net/wp-content/uploads/2020/12/252164-DangerousToGoAlone.jpg" class="img-fluid"></p>
</div>
</div>
<ul>
<li><p>1- <a href="https://oxford.universitypressscholarship.com/view/10.1093/acprof:oso/9780199672547.001.0001/acprof-9780199672547">Fox *et al.* 2015. Ecological Statistics: Contemporary theory and application</a></p></li>
<li><p>2- <a href="https://www.routledge.com/Spatial-Data-Analysis-in-Ecology-and-Agriculture-Using-R/Plant/p/book/9780367732325">Plant 2019. Spatial Data Analysis in Ecology and Agriculture Using R</a></p></li>
<li><p>3- <a href="https://onlinelibrary.wiley.com/doi/10.1111/j.2007.0906-7590.05171.x">Dorman *et al.* 2007. Methods to account for spatial autocorrelation in the analysis of species distributional data: a review</a></p></li>
<li><p>4- <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1365-2699.2012.02707.x">Kuhn &amp; Dorman 2012. Less than eight (and a half) misconceptions of spatial analysis</a></p></li>
<li><p>5- <a href="https://link.springer.com/book/10.1007/978-3-030-01989-1">Fletcher &amp; Fortin 2018. Spatial Ecology and Conservation</a></p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->



<script src="index_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>